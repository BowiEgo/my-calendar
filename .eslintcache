[{"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/CalendarGrid.js":"1","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/CalendarGridPointer.js":"2","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/CalendarGridTable.js":"3","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/index.js":"4","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/reportWebVitals.js":"5","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/themes.js":"6","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/index.js":"7","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/index.js":"8","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskBlock/TaskBlock.js":"9","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskBlock/TaskBlockSolid.js":"10","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useLongPress.js":"11","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/store/index.js":"12","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Modal/index.js":"13","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/index.js":"14","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/App.js":"15","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useClickOutside.js":"16","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/Calendar/Calendar.js":"17","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/Calendar/CalendarCell.js":"18","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/Playground.js":"19","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarList.js":"20","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/SearchBar.js":"21","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskBlock/index.js":"22","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useMousePosition.js":"23","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Modal/Modal.js":"24","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/NavBar.js":"25","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/reqFrame.js":"26","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Button/Button.js":"27","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskEditor/TaskEditor.js":"28","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useActions.js":"29","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskEditor/index.js":"30","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Button/index.js":"31","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Button/ButtonGroup.js":"32","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/Calendar/index.js":"33","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Switch/index.js":"34","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarType/index.js":"35","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarType/CalendarType.js":"36","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Switch/Switch.js":"37","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/BackForwardSwitch/index.js":"38","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/BackForwardSwitch/BackForwardSwitch.js":"39","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/usePrevious.js":"40","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/useGridMotion.js":"41","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/Calendar/useWeekBarMotion.js":"42","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useHistory.js":"43","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/TableEl.js":"44"},{"size":6717,"mtime":1612494605878,"results":"45","hashOfConfig":"46"},{"size":2202,"mtime":1612324338630,"results":"47","hashOfConfig":"46"},{"size":8303,"mtime":1613982348360,"results":"48","hashOfConfig":"46"},{"size":948,"mtime":1612835856248,"results":"49","hashOfConfig":"46"},{"size":362,"mtime":1608534016529,"results":"50","hashOfConfig":"46"},{"size":630,"mtime":1608866650308,"results":"51","hashOfConfig":"46"},{"size":922,"mtime":1612426030180,"results":"52","hashOfConfig":"46"},{"size":219,"mtime":1611047274135,"results":"53","hashOfConfig":"46"},{"size":3557,"mtime":1613982312792,"results":"54","hashOfConfig":"46"},{"size":1151,"mtime":1613722402718,"results":"55","hashOfConfig":"46"},{"size":1866,"mtime":1610540756719,"results":"56","hashOfConfig":"46"},{"size":796,"mtime":1612518269051,"results":"57","hashOfConfig":"46"},{"size":35,"mtime":1612168659419,"results":"58","hashOfConfig":"46"},{"size":427,"mtime":1612425932187,"results":"59","hashOfConfig":"46"},{"size":4806,"mtime":1612515165268,"results":"60","hashOfConfig":"46"},{"size":582,"mtime":1612164675854,"results":"61","hashOfConfig":"46"},{"size":8590,"mtime":1613716054829,"results":"62","hashOfConfig":"46"},{"size":1969,"mtime":1612423634773,"results":"63","hashOfConfig":"46"},{"size":1246,"mtime":1610696760726,"results":"64","hashOfConfig":"46"},{"size":1527,"mtime":1608868003458,"results":"65","hashOfConfig":"46"},{"size":926,"mtime":1609143510882,"results":"66","hashOfConfig":"46"},{"size":123,"mtime":1610453946174,"results":"67","hashOfConfig":"46"},{"size":1108,"mtime":1610527837909,"results":"68","hashOfConfig":"46"},{"size":1467,"mtime":1612507454767,"results":"69","hashOfConfig":"46"},{"size":518,"mtime":1609142950028,"results":"70","hashOfConfig":"46"},{"size":802,"mtime":1609832470250,"results":"71","hashOfConfig":"46"},{"size":1257,"mtime":1612170159400,"results":"72","hashOfConfig":"46"},{"size":1349,"mtime":1612514374405,"results":"73","hashOfConfig":"46"},{"size":962,"mtime":1612171810371,"results":"74","hashOfConfig":"46"},{"size":40,"mtime":1612168897749,"results":"75","hashOfConfig":"46"},{"size":105,"mtime":1612168728657,"results":"76","hashOfConfig":"46"},{"size":215,"mtime":1612168688480,"results":"77","hashOfConfig":"46"},{"size":114,"mtime":1612168447456,"results":"78","hashOfConfig":"46"},{"size":36,"mtime":1612425770385,"results":"79","hashOfConfig":"46"},{"size":69,"mtime":1612425993184,"results":"80","hashOfConfig":"46"},{"size":612,"mtime":1612426286561,"results":"81","hashOfConfig":"46"},{"size":1976,"mtime":1612424849690,"results":"82","hashOfConfig":"46"},{"size":47,"mtime":1612425887281,"results":"83","hashOfConfig":"46"},{"size":1348,"mtime":1612426401968,"results":"84","hashOfConfig":"46"},{"size":204,"mtime":1612439881763,"results":"85","hashOfConfig":"46"},{"size":1176,"mtime":1612839605963,"results":"86","hashOfConfig":"46"},{"size":928,"mtime":1613978629560,"results":"87","hashOfConfig":"46"},{"size":942,"mtime":1613978605430,"results":"88","hashOfConfig":"46"},{"size":2777,"mtime":1613981661470,"results":"89","hashOfConfig":"46"},{"filePath":"90","messages":"91","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"92","usedDeprecatedRules":"93"},"nwanja",{"filePath":"94","messages":"95","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"97","messages":"98","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"99","messages":"100","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"101"},{"filePath":"102","messages":"103","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"104"},{"filePath":"105","messages":"106","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"107"},{"filePath":"108","messages":"109","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"110","messages":"111","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"112"},{"filePath":"113","messages":"114","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"115","messages":"116","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"117","messages":"118","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"119","messages":"120","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"121","messages":"122","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"104"},{"filePath":"123","messages":"124","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"125","messages":"126","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"127","messages":"128","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"129","messages":"130","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"131","usedDeprecatedRules":"96"},{"filePath":"132","messages":"133","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"134","usedDeprecatedRules":"93"},{"filePath":"135","messages":"136","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"107"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"107"},{"filePath":"139","messages":"140","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"141","messages":"142","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"143","messages":"144","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"104"},{"filePath":"145","messages":"146","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"147","messages":"148","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"149","messages":"150","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"112"},{"filePath":"151","messages":"152","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"104"},{"filePath":"153","messages":"154","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"155","messages":"156","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"157","messages":"158","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"104"},{"filePath":"159","messages":"160","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"107"},{"filePath":"161","messages":"162","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"163","messages":"164","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"165","messages":"166","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"167","messages":"168","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"169","messages":"170","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"171","messages":"172","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"112"},{"filePath":"173","messages":"174","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},{"filePath":"175","messages":"176","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"93"},{"filePath":"177","messages":"178","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"179","messages":"180","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"181","usedDeprecatedRules":"107"},{"filePath":"182","messages":"183","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"184","messages":"185","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"186","messages":"187","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"96"},"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/CalendarGrid.js",["188"],"import { useState, useEffect, useRef, Fragment, forwardRef } from 'react';\nimport styled from 'styled-components';\nimport moment from 'moment';\nimport { Calendar as CalendarIcon } from 'react-feather';\nimport {\n  CalendarGridTable as GridTable,\n  CalendarGridPointer as GridPointer,\n} from '../index';\nimport useGridMotion from './useGridMotion';\nimport useMousePosition from '../../utils/useMousePosition';\nimport usePrevious from '../../utils/usePrevious';\n\nlet bid = 0;\n\nconst CalendarGrid = ({ selectedDate, week, scrollTop }) => {\n  // console.log('grid-update');\n\n  // ref\n  const weekdaysShort = useRef(moment.weekdaysShort());\n  const containerRef = useRef();\n  const scrollRef = useRef();\n  const labelElRef = useRef();\n  const motionTable = useRef();\n  const tableHeight = useRef(0);\n  const tableWidth = useRef(0);\n  const labelWidth = useRef(0);\n\n  // previous\n  const oldWeekValue = usePrevious(week);\n\n  // motion\n  const { motion, motionProps, motionHandlers } = useGridMotion();\n\n  // mounted\n  useEffect(() => {\n    labelWidth.current = labelElRef.current.getBoundingClientRect().width;\n  }, []);\n\n  const { mousePosition, bind: mouseEvent } = useMousePosition(pos => {\n    let posX = pos.x - labelWidth.current;\n\n    return {\n      x: posX < 0 ? 0 : posX,\n      y: pos.y,\n    };\n  });\n\n  useEffect(() => {\n    if ((week !== undefined) & (oldWeekValue !== undefined)) {\n      if (week[0] < oldWeekValue[0]) {\n        motionHandlers.prev();\n      } else if (week[0] > oldWeekValue[0]) {\n        motionHandlers.next();\n      }\n    }\n  }, [week]);\n\n  // method\n  const handleTableMounted = tableBCR => {\n    tableHeight.current = tableBCR.height;\n    tableWidth.current = tableBCR.width;\n  };\n\n  const handlePointerInitialed = pointerTop => {\n    scrollRef.current.scrollTop =\n      pointerTop - scrollRef.current.getBoundingClientRect().height / 2;\n  };\n\n  const renderWeekList = () => {\n    return week.map((unix, idx) => {\n      const date = moment(unix);\n      return (\n        <motion.div\n          key={idx}\n          {...motionProps}\n          style={{ height: '100%', flex: 1 }}\n        >\n          <WeekCell\n            isActive={date.isSame(moment(selectedDate))}\n            isToday={date.isSame(moment().startOf('day'))}\n          >\n            <h5>{weekdaysShort[date.weekday()]}</h5>\n            <span>{date.date()}</span>\n          </WeekCell>\n        </motion.div>\n      );\n    });\n  };\n\n  // TimeLabel\n  const renderTimeLabel = () => {\n    let ht = 0;\n    const hours = Array(24)\n      .fill(0)\n      .map(() => ht++);\n\n    return (\n      <div>\n        {hours.map((h, index) => (\n          <GridLabelCell key={index}>\n            <span>{h < 10 ? `0${h}:00` : `${h}:00`}</span>\n            <Tick width={16} top={'25%'}></Tick>\n            <Tick width={32} top={'50%'}></Tick>\n            <Tick width={16} top={'75%'}></Tick>\n          </GridLabelCell>\n        ))}\n      </div>\n    );\n  };\n\n  return (\n    <GridContainer ref={containerRef}>\n      <GridWeekContainer>\n        <GridWeek>\n          <WeekLabelContainer>\n            <WeekLabel>\n              <CalendarIcon color=\"grey\" size=\"20\"></CalendarIcon>\n            </WeekLabel>\n          </WeekLabelContainer>\n          {renderWeekList()}\n        </GridWeek>\n      </GridWeekContainer>\n      <GridContentScroll {...mouseEvent} ref={scrollRef}>\n        <GridContent>\n          <GridLabel ref={labelElRef}>{renderTimeLabel()}</GridLabel>\n          <GridPointer\n            tableHeight={tableHeight.current}\n            tableWidth={tableWidth.current}\n            onInitialed={handlePointerInitialed}\n          ></GridPointer>\n          <motion.div {...motionProps} style={{ height: '100%', flex: 1 }}>\n            <GridTable\n              week={week}\n              mousePosition={mousePosition}\n              onMounted={handleTableMounted}\n            ></GridTable>\n          </motion.div>\n        </GridContent>\n      </GridContentScroll>\n    </GridContainer>\n  );\n};\n\nconst GridContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: #fff;\n`;\n\nconst GridWeekContainer = styled.div`\n  display: flex;\n  height: 6.4vw;\n`;\n\nconst GridWeek = styled.div`\n  display: flex;\n  flex: 1;\n  border-top: 1px solid ${props => props.theme.borderColor};\n  border-bottom: 1px solid ${props => props.theme.borderColor};\n  background-color: ${props => props.theme.primaryColorTertiary};\n`;\n\nconst WeekLabelContainer = styled.div`\n  position: relative;\n  width: 60px;\n  padding: 4px;\n  display: flex;\n  &::after {\n    content: '';\n    display: block;\n    width: 1px;\n    height: 100%;\n    position: absolute;\n    right: -1px;\n    top: 0;\n    background-color: ${props => props.theme.borderColor};\n  }\n`;\n\nconst WeekLabel = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  border-radius: 3px;\n  background-color: ${props => props.theme.primaryColorSecondary};\n`;\n\nconst WeekCell = styled.div`\n  flex: 1;\n  height: 100%;\n  padding: 10px 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  border-right: 1px solid ${props => props.theme.borderColor};\n  line-height: 26px;\n  h5 {\n    margin: 0;\n    font-weight: 600;\n    color: ${props => {\n      if (props.isActive) {\n        return props.theme.primaryColor;\n      } else if (props.isToday) {\n        return props.theme.hightlightColor;\n      }\n      return props.theme.textColor;\n    }};\n  }\n  span {\n    font-size: 14px;\n    color: ${props => {\n      if (props.isActive) {\n        return props.theme.primaryColor;\n      } else if (props.isToday) {\n        return props.theme.hightlightColor;\n      }\n      return props.theme.textColorSecondary;\n    }};\n  }\n`;\n\nconst GridContentScroll = styled.div`\n  position: relative;\n  overflow-y: scroll;\n  width: calc(100% + 4px);\n  display: flex;\n  flex: 1 1 auto;\n  height: 0px;\n  &:hover::-webkit-scrollbar-thumb {\n    visibility: visible;\n  }\n  align-items: flex-start; // 使子元素撑满搞度\n`;\n\nconst GridContent = styled.div`\n  display: flex;\n  flex: 1;\n  min-height: min-content;\n`;\n\nconst GridLabel = styled.div`\n  width: 60px;\n  font-size: 14px;\n  color: #9e9e9e;\n  border-right: 1px solid ${props => props.theme.borderColor};\n  box-sizing: content-box;\n`;\n\nconst GridLabelCell = styled.div`\n  position: relative;\n  height: 7vw;\n  display: flex;\n  flex-direction: column;\n  &:first-child span {\n    display: none;\n  }\n  span {\n    display: block;\n    transform: translateY(-6px);\n  }\n`;\n\nconst Tick = styled.div`\n  position: absolute;\n  left: 0;\n  top: ${props => props.top};\n  width: ${props => props.width + 'px'};\n  height: 1px;\n  background-color: ${props => props.theme.tickColor};\n`;\n\nexport default CalendarGrid;\n",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/CalendarGridPointer.js",[],[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/CalendarGridTable.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/index.js",[],[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/reportWebVitals.js",[],[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/themes.js",[],[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/index.js",[],[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskBlock/TaskBlock.js",["189"],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskBlock/TaskBlockSolid.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useLongPress.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/store/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Modal/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/App.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useClickOutside.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/Calendar/Calendar.js",["190","191"],"import {\n  useRef,\n  useEffect,\n  useMemo,\n  useContext,\n  useCallback,\n  useImperativeHandle,\n  forwardRef,\n} from 'react';\nimport { useImmer } from 'use-immer';\nimport styled, { ThemeContext } from 'styled-components';\nimport moment, { unix } from 'moment';\nimport { ChevronLeft, ChevronRight } from 'react-feather';\nimport { Button, ButtonGroup } from '../../components';\nimport { CalendarCell } from '../index';\nimport useWeekBarMotion from './useWeekBarMotion';\nimport useHistory from '../../utils/useHistory';\n\nconst nowUnix = new Date().getTime();\nconst nowMoment = moment(nowUnix);\nconst startOfCurrentMonthTmp = +nowMoment.clone().startOf('month').format('x');\nconst {\n  calendar: calendarTmp,\n  weekIndex: indexOfSelectedWeekTmp,\n} = getCalendar(nowUnix, +nowMoment.clone().startOf('day').format('x'));\n\nconst initialState = {\n  calendar: calendarTmp,\n  startOfSelectedCalendar: null,\n  indexOfSelectedWeek: indexOfSelectedWeekTmp,\n};\n\nconst Calendar = forwardRef(({ onChange, onChangeWeek }, ref) => {\n  // context\n  const themeContext = useContext(ThemeContext);\n\n  // state\n  const [\n    { calendar, startOfSelectedCalendar, indexOfSelectedWeek },\n    updateState,\n  ] = useImmer(initialState);\n\n  // ref\n  const todayUnix = useRef(+moment().startOf('day').format('x'));\n  const selectedDate = useRef();\n  const startOfCurrentMonth = useRef(startOfCurrentMonthTmp);\n  const initialWeekIndex = useRef(-1);\n\n  // history\n  const {\n    present: startOfSelectedWeek,\n    update: updateSSW,\n    getPast: getPastOfSSW,\n  } = useHistory(calendarTmp[indexOfSelectedWeekTmp][0], { size: 2 });\n\n  // motion\n  const { motion, motionProps, motionHandlers } = useWeekBarMotion({\n    pos: indexOfSelectedWeek + 1,\n    initialPos: initialWeekIndex.current + 1,\n    fixY: 2,\n    resolveFn: () => {},\n  });\n\n  useEffect(() => {\n    if (indexOfSelectedWeek > -1) {\n      onChangeWeek && onChangeWeek(calendar[indexOfSelectedWeek]);\n    }\n  }, [indexOfSelectedWeek, onChangeWeek]);\n\n  // method\n  const prevMonth = startOfWeek => {\n    startOfCurrentMonth.current = +moment(startOfCurrentMonth.current)\n      .subtract(1, 'month')\n      .format('x');\n\n    updateCalendar(startOfWeek);\n  };\n\n  const nextMonth = startOfWeek => {\n    startOfCurrentMonth.current = +moment(startOfCurrentMonth.current)\n      .add(1, 'month')\n      .format('x');\n\n    updateCalendar(startOfWeek);\n  };\n\n  const updateCalendar = startOfWeek => {\n    const { calendar, weekIndex } = getCalendar(\n      startOfCurrentMonth.current,\n      startOfWeek || startOfSelectedWeek,\n    );\n\n    initialWeekIndex.current = startOfWeek\n      ? findWeekIndexByStart(getPastOfSSW(1)[0], calendar)\n      : weekIndex;\n\n    updateState(draft => {\n      draft.indexOfSelectedWeek = weekIndex;\n      draft.calendar = calendar;\n    });\n  };\n\n  const handleCellClicked = useCallback(\n    unix => {\n      if (unix === selectedDate.current) return;\n      selectedDate.current = unix;\n      onChange && onChange(unix);\n\n      const weekStartUnix = +moment(unix).startOf('week').format('x');\n\n      if (weekStartUnix !== startOfSelectedWeek) {\n        const row = getRow(unix, startOfCurrentMonth.current);\n\n        updateSSW(weekStartUnix);\n        updateState(draft => {\n          draft.startOfSelectedCalendar = calendar[0][0];\n          draft.indexOfSelectedWeek = row;\n        });\n      }\n    },\n    [\n      calendar,\n      indexOfSelectedWeek,\n      startOfSelectedWeek,\n      onChange,\n      updateState,\n      updateSSW,\n    ],\n  );\n\n  useImperativeHandle(ref, () => ({\n    prevWeek: () => {\n      if (indexOfSelectedWeek > 0) {\n        initialWeekIndex.current = indexOfSelectedWeek;\n        updateState(draft => {\n          draft.indexOfSelectedWeek--;\n          updateSSW(calendar[draft.indexOfSelectedWeek][0]);\n        });\n      } else {\n        let startOfWeek = +moment(calendar[0][0])\n          .subtract(1, 'week')\n          .format('x');\n\n        updateSSW(startOfWeek);\n        prevMonth(startOfWeek);\n      }\n    },\n    nextWeek: () => {\n      if (indexOfSelectedWeek < 5) {\n        initialWeekIndex.current = indexOfSelectedWeek;\n        updateState(draft => {\n          draft.indexOfSelectedWeek++;\n          updateSSW(calendar[draft.indexOfSelectedWeek][0]);\n        });\n      } else {\n        let startOfWeek = +moment(calendar[5][0]).add(1, 'week').format('x');\n\n        updateSSW(startOfWeek);\n        nextMonth(startOfWeek);\n      }\n    },\n  }));\n\n  const renderTableHead = () => {\n    return (\n      <tr>\n        {['日', '一', '二', '三', '四', '五', '六'].map((name, idx) => {\n          return (\n            <Th as=\"th\" key={idx}>\n              {name}\n            </Th>\n          );\n        })}\n      </tr>\n    );\n  };\n\n  const renderTableBody = () =>\n    calendar.map((week, row) => {\n      return (\n        <tr key={row}>\n          {week.map((unix, col) => {\n            const isToday = unix === todayUnix.current;\n            const isCurrentMonth =\n              +moment(unix).startOf('month').format('x') ===\n              startOfCurrentMonth.current;\n            const isActive = unix === selectedDate.current;\n            return (\n              <Td key={col}>\n                <CalendarCell\n                  unix={unix}\n                  isToday={isToday}\n                  isCurrentMonth={isCurrentMonth}\n                  isActive={isActive}\n                  onClick={handleCellClicked}\n                />\n              </Td>\n            );\n          })}\n        </tr>\n      );\n    });\n\n  return (\n    <Container ref={ref}>\n      <CalendarHeader>\n        <MonthHeader>\n          {moment(startOfCurrentMonth.current).format('YYYY年 MM月')}\n        </MonthHeader>\n\n        <ButtonGroup width=\"66\">\n          <MonthButton width={30} border onClick={() => prevMonth()}>\n            <ChevronLeft color={themeContext.textColor} size={14} />\n          </MonthButton>\n          <MonthButton width={30} border onClick={() => nextMonth()}>\n            <ChevronRight color={themeContext.textColor} size={14} />\n          </MonthButton>\n        </ButtonGroup>\n      </CalendarHeader>\n\n      <div style={{ position: 'relative' }}>\n        <motion.div {...motionProps}>\n          <WeekBar visible={indexOfSelectedWeek > -1}></WeekBar>\n        </motion.div>\n        <table>\n          <thead>{renderTableHead()}</thead>\n          <tbody>{renderTableBody()}</tbody>\n        </table>\n      </div>\n    </Container>\n  );\n});\n\nfunction getCalendar(unix, startOfWeekUnix) {\n  let calendar = [];\n  let weekIndex = -1;\n  let idx = 0;\n  const date = moment(unix);\n\n  const startDay = date.clone().startOf('month').startOf('week');\n  const endDay = date.clone().endOf('month').endOf('week');\n\n  let tempDate = startDay.clone().subtract(1, 'day');\n\n  while (tempDate.isBefore(endDay, 'day') || !calendar[5]) {\n    calendar.push(\n      Array(7)\n        .fill(0)\n        .map(() => {\n          const d = +tempDate.add(1, 'day').format('x');\n          if (d === startOfWeekUnix) {\n            weekIndex = idx;\n          }\n          return d;\n        }),\n    );\n    idx++;\n  }\n\n  return { calendar, weekIndex };\n}\n\nfunction getRow(unix, startDayUnix) {\n  const startDay = moment(startDayUnix).startOf('month').startOf('week');\n  let row = Math.ceil(\n    (moment(unix).startOf('day').diff(startDay, 'days') + 0.1) / 7,\n  );\n  row = row <= 0 ? 0 : row - 1;\n  return row;\n}\n\nfunction findWeekIndexByStart(startOfWeek, calendar) {\n  for (let i = 0; i < calendar.length; i++) {\n    if (calendar[i][0] === startOfWeek) {\n      return i;\n    }\n  }\n}\n\nconst Container = styled.div`\n  position: relative;\n  width: 100%;\n  background-color: transparent;\n  user-select: none;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\n\nconst CalendarHeader = styled.div`\n  width: 100%;\n  padding: 16px 7px 10px 0;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\nconst MonthHeader = styled.div`\n  font-weight: 600;\n  text-align: left;\n  margin: 0 10px;\n  flex: 1;\n`;\n\nconst MonthButton = styled(Button)`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst WeekBar = styled.div.attrs(props => ({\n  style: {\n    display: props.visible ? 'block' : 'none',\n  },\n}))`\n  width: 100%;\n  height: 34px;\n  border-radius: 8px;\n  background-color: ${props => props.theme.primaryColorSecondary};\n  z-index: -1;\n`;\n\nconst Td = styled.td`\n  width: 34px;\n  height: 34px;\n  font-size: ${props => props.theme.fontSize};\n  font-weight: 500;\n  color: ${props => props.theme.textColor};\n`;\n\nconst Th = styled(Td)`\n  color: ${props => props.theme.textColorSecondary};\n`;\n\nexport default Calendar;\n","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/Calendar/CalendarCell.js",["192","193"],"import { memo, useMemo, useRef, useContext, useEffect } from 'react';\nimport styled, { ThemeContext } from 'styled-components';\nimport moment from 'moment';\n\nconst CalendarCell = memo(\n  ({ unix, isToday, isCurrentMonth, isActive, onClick }) => {\n    // context\n    const themeContext = useContext(ThemeContext);\n\n    // memo\n    const date = useMemo(() => moment(+unix), [unix]);\n    const isRound = useMemo(() => isActive || isToday, [isActive, isToday]);\n    const backgroundColor = useMemo(() => {\n      if (isActive) {\n        return themeContext.primaryColor;\n      } else if (isToday) {\n        return themeContext.hightlightColor;\n      } else {\n        return 'inherit';\n      }\n    }, [isActive, isToday]);\n\n    const textColor = useMemo(() => {\n      if (isActive || isToday) {\n        return 'white';\n      } else if (!isCurrentMonth) {\n        return themeContext.disabledColor;\n      } else {\n        return themeContext.textColor;\n      }\n    }, [isCurrentMonth, isActive, isToday]);\n\n    // render\n    return unix ? (\n      <Container onClick={() => onClick(unix)}>\n        <Cell\n          backgroundColor={backgroundColor}\n          color={textColor}\n          round={isRound}\n        >\n          {date.date()}\n        </Cell>\n      </Container>\n    ) : (\n      <div />\n    );\n  },\n  (prev, next) => {\n    const keys = ['unix', 'isToday', 'isCurrentMonth', 'isActive'];\n    for (let i = 0; i < keys.length; i++) {\n      let key = keys[i];\n      if (prev[key] !== next[key]) {\n        return false;\n      }\n    }\n    return true;\n  },\n);\n\nconst Container = styled.div`\n  cursor: pointer;\n  width: 100%;\n  height: 100%;\n`;\n\nconst Cell = styled.div.attrs(props => ({\n  style: {\n    backgroundColor: props.backgroundColor,\n    color: props.color,\n    borderRadius: props.round ? '8px' : 0,\n  },\n}))`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-family: 'Roboto';\n`;\n\nexport default CalendarCell;\n","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/Playground.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarList.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/SearchBar.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskBlock/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useMousePosition.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Modal/Modal.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/NavBar.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/reqFrame.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Button/Button.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskEditor/TaskEditor.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useActions.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/TaskEditor/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Button/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Button/ButtonGroup.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/Calendar/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Switch/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarType/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarType/CalendarType.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/Switch/Switch.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/BackForwardSwitch/index.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/components/BackForwardSwitch/BackForwardSwitch.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/usePrevious.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/useGridMotion.js",["194"],"import { useState, useEffect } from 'react';\nimport {\n  motion,\n  useAnimation,\n  useMotionValue,\n  useTransform,\n} from 'framer-motion';\n\nconst useGridMotion = ({ resolveFn } = {}) => {\n  const [weekSwitchStatus, setWeekSwitchStatus] = useState('static');\n\n  const control = useAnimation();\n\n  useEffect(() => {\n    switchPromise.then(() => resolveFn && resolveFn());\n  }, [weekSwitchStatus]);\n\n  const prev = () => {\n    setWeekSwitchStatus('prev');\n  };\n\n  const next = () => {\n    setWeekSwitchStatus('next');\n  };\n\n  const switchPromise = new Promise((resolve, reject) => {\n    if (weekSwitchStatus !== 'static') {\n      if (weekSwitchStatus === 'prev') {\n        control.set({ x: -80, opacity: 0 });\n        control.start({ x: 0, opacity: 1 });\n      } else {\n        control.set({ x: 80, opacity: 0 });\n        control.start({ x: 0, opacity: 1 });\n      }\n      setTimeout(() => {\n        setWeekSwitchStatus('static');\n        resolve();\n      }, 300);\n    }\n  });\n\n  return {\n    motion,\n    motionProps: {\n      animate: control,\n      transition: { duration: 0.3 },\n    },\n    motionHandlers: {\n      prev,\n      next,\n    },\n  };\n};\n\nexport default useGridMotion;\n","/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/Calendar/useWeekBarMotion.js",["195","196"],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/utils/useHistory.js",[],"/Users/bowiego/Documents/Playground/react-demo/my-calendar/src/widgets/CalendarGrid/TableEl.js",[],{"ruleId":"197","severity":1,"message":"198","line":56,"column":6,"nodeType":"199","endLine":56,"endColumn":12,"suggestions":"200"},{"ruleId":"197","severity":1,"message":"201","line":51,"column":8,"nodeType":"199","endLine":51,"endColumn":26,"suggestions":"202"},{"ruleId":"197","severity":1,"message":"203","line":68,"column":6,"nodeType":"199","endLine":68,"endColumn":41,"suggestions":"204"},{"ruleId":"197","severity":1,"message":"205","line":121,"column":5,"nodeType":"199","endLine":128,"endColumn":6,"suggestions":"206"},{"ruleId":"197","severity":1,"message":"207","line":21,"column":8,"nodeType":"199","endLine":21,"endColumn":27,"suggestions":"208"},{"ruleId":"197","severity":1,"message":"209","line":31,"column":8,"nodeType":"199","endLine":31,"endColumn":43,"suggestions":"210"},{"ruleId":"197","severity":1,"message":"211","line":16,"column":6,"nodeType":"199","endLine":16,"endColumn":24,"suggestions":"212"},{"ruleId":"197","severity":1,"message":"213","line":13,"column":6,"nodeType":"199","endLine":13,"endColumn":11,"suggestions":"214"},{"ruleId":"197","severity":1,"message":"215","line":26,"column":6,"nodeType":"199","endLine":26,"endColumn":11,"suggestions":"216"},"react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'motionHandlers' and 'oldWeekValue'. Either include them or remove the dependency array.","ArrayExpression",["217"],"React Hook useMemo has a missing dependency: 'isSolid'. Either include it or remove the dependency array.",["218"],"React Hook useEffect has a missing dependency: 'calendar'. Either include it or remove the dependency array.",["219"],"React Hook useCallback has an unnecessary dependency: 'indexOfSelectedWeek'. Either exclude it or remove the dependency array.",["220"],"React Hook useMemo has missing dependencies: 'themeContext.hightlightColor' and 'themeContext.primaryColor'. Either include them or remove the dependency array.",["221"],"React Hook useMemo has missing dependencies: 'themeContext.disabledColor' and 'themeContext.textColor'. Either include them or remove the dependency array.",["222"],"React Hook useEffect has missing dependencies: 'resolveFn' and 'switchPromise'. Either include them or remove the dependency array. If 'resolveFn' changes too often, find the parent component that defines it and wrap that definition in useCallback.",["223"],"React Hook useEffect has a missing dependency: 'animePromise'. Either include it or remove the dependency array.",["224"],"React Hook useCallback has missing dependencies: 'control', 'fixY', and 'initialPos'. Either include them or remove the dependency array.",["225"],{"desc":"226","fix":"227"},{"desc":"228","fix":"229"},{"desc":"230","fix":"231"},{"desc":"232","fix":"233"},{"desc":"234","fix":"235"},{"desc":"236","fix":"237"},{"desc":"238","fix":"239"},{"desc":"240","fix":"241"},{"desc":"242","fix":"243"},"Update the dependencies array to be: [motionHandlers, oldWeekValue, week]",{"range":"244","text":"245"},"Update the dependencies array to be: [resizing, moving, isSolid]",{"range":"246","text":"247"},"Update the dependencies array to be: [calendar, indexOfSelectedWeek, onChangeWeek]",{"range":"248","text":"249"},"Update the dependencies array to be: [calendar, startOfSelectedWeek, onChange, updateState, updateSSW]",{"range":"250","text":"251"},"Update the dependencies array to be: [isActive, isToday, themeContext.hightlightColor, themeContext.primaryColor]",{"range":"252","text":"253"},"Update the dependencies array to be: [isActive, isToday, isCurrentMonth, themeContext.disabledColor, themeContext.textColor]",{"range":"254","text":"255"},"Update the dependencies array to be: [resolveFn, switchPromise, weekSwitchStatus]",{"range":"256","text":"257"},"Update the dependencies array to be: [animePromise, pos]",{"range":"258","text":"259"},"Update the dependencies array to be: [control, fixY, initialPos, pos]",{"range":"260","text":"261"},[1553,1559],"[motionHandlers, oldWeekValue, week]",[1088,1106],"[resizing, moving, isSolid]",[1938,1973],"[calendar, indexOfSelectedWeek, onChangeWeek]",[3351,3480],"[calendar, startOfSelectedWeek, onChange, updateState, updateSSW]",[695,714],"[isActive, isToday, themeContext.hightlightColor, themeContext.primaryColor]",[961,996],"[isActive, isToday, isCurrentMonth, themeContext.disabledColor, themeContext.textColor]",[374,392],"[resolveFn, switchPromise, weekSwitchStatus]",[308,313],"[animePromise, pos]",[577,582],"[control, fixY, initialPos, pos]"]